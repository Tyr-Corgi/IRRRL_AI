@using static IRRRL.Web.Pages.Veteran.Apply

<h4 class="mb-4">Declarations</h4>

<div class="alert alert-info mb-4">
    <strong>üìã Streamlined IRRRL Questions</strong>
    <p class="mb-0">Since this is a streamlined refinance, we only need essential information. Answer truthfully - your loan officer may request documentation if needed.</p>
</div>

<EditForm Model="@Model" OnValidSubmit="HandleNext">
    <DataAnnotationsValidator />

    <div class="card mb-3">
        <div class="card-header bg-primary text-white">
            <strong>Property Occupancy (Required)</strong>
        </div>
        <div class="card-body">
            <div class="mb-3">
                <label class="form-label">Do you intend to occupy the property as your primary residence? <span class="text-danger">*</span></label>
                <InputRadioGroup @bind-Value="Model.IntendToOccupyProperty">
                    <div class="form-check">
                        <InputRadio Value="@true" class="form-check-input" id="occupyYes" />
                        <label class="form-check-label" for="occupyYes">
                            <strong>Yes</strong> - This will be my primary residence
                        </label>
                    </div>
                    <div class="form-check">
                        <InputRadio Value="@false" class="form-check-input" id="occupyNo" />
                        <label class="form-check-label" for="occupyNo">
                            <strong>No</strong> - This is/was my primary residence (now rental/second home)
                        </label>
                    </div>
                </InputRadioGroup>
                <ValidationMessage For="@(() => Model.IntendToOccupyProperty)" class="text-danger" />
                <small class="text-muted d-block mt-2">Note: IRRRL requires you previously occupied this as your primary residence</small>
            </div>
        </div>
    </div>

    <div class="card mb-3">
        <div class="card-header bg-primary text-white">
            <strong>Credit History</strong>
        </div>
        <div class="card-body">
            <p class="text-muted small mb-3">Please answer yes or no to each question:</p>

            <div class="mb-3">
                <label class="form-label">Have you declared bankruptcy within the past 7 years? <span class="text-danger">*</span></label>
                <InputRadioGroup @bind-Value="Model.HasBankruptcy">
                    <div class="form-check">
                        <InputRadio Value="@true" class="form-check-input" id="bankruptcyYes" />
                        <label class="form-check-label" for="bankruptcyYes">Yes</label>
                    </div>
                    <div class="form-check">
                        <InputRadio Value="@false" class="form-check-input" id="bankruptcyNo" />
                        <label class="form-check-label" for="bankruptcyNo">No</label>
                    </div>
                </InputRadioGroup>
                <ValidationMessage For="@(() => Model.HasBankruptcy)" class="text-danger" />
            </div>

            @if (Model.HasBankruptcy)
            {
                <div class="ms-4 mb-3">
                    <label class="form-label">Bankruptcy Type</label>
                    <InputSelect @bind-Value="Model.BankruptcyType" class="form-select">
                        <option value="">Select Type</option>
                        <option value="Chapter7">Chapter 7</option>
                        <option value="Chapter11">Chapter 11</option>
                        <option value="Chapter13">Chapter 13</option>
                    </InputSelect>
                </div>
                <div class="ms-4 mb-3">
                    <label class="form-label">Bankruptcy Discharge/Dismissal Date</label>
                    <InputDate @bind-Value="Model.BankruptcyDischargeDate" class="form-control" />
                </div>
            }

            <div class="mb-3">
                <label class="form-label">Have you had property foreclosed upon or given title or deed in lieu thereof in the past 7 years? <span class="text-danger">*</span></label>
                <InputRadioGroup @bind-Value="Model.HasForeclosure">
                    <div class="form-check">
                        <InputRadio Value="@true" class="form-check-input" id="foreclosureYes" />
                        <label class="form-check-label" for="foreclosureYes">Yes</label>
                    </div>
                    <div class="form-check">
                        <InputRadio Value="@false" class="form-check-input" id="foreclosureNo" />
                        <label class="form-check-label" for="foreclosureNo">No</label>
                    </div>
                </InputRadioGroup>
                <ValidationMessage For="@(() => Model.HasForeclosure)" class="text-danger" />
            </div>

            @if (Model.HasForeclosure)
            {
                <div class="ms-4 mb-3">
                    <label class="form-label">Foreclosure Completion Date</label>
                    <InputDate @bind-Value="Model.ForeclosureCompletionDate" class="form-control" />
                </div>
            }
        </div>
    </div>

    <div class="alert alert-info">
        <strong>üìã What Happens Next:</strong>
        <p class="mb-0">Your loan officer will review these declarations and may request additional documentation if you answered "Yes" to any questions above.</p>
    </div>

    <div class="d-flex justify-content-between mt-4">
        <button type="button" class="btn btn-outline-secondary btn-lg" @onclick="HandleBack">
            ‚Üê Back
        </button>
        <button type="submit" class="btn btn-primary btn-lg">
            Next: Demographics ‚Üí
        </button>
    </div>
</EditForm>

@code {
    [Parameter] public ApplicationFormModel Model { get; set; } = new();
    [Parameter] public EventCallback OnNext { get; set; }
    [Parameter] public EventCallback OnBack { get; set; }

    private async Task HandleNext()
    {
        await OnNext.InvokeAsync();
    }

    private async Task HandleBack()
    {
        await OnBack.InvokeAsync();
    }
}

